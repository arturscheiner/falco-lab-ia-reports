**Security Alert Report**
==========================

**Alert Details**
-----------------

### UUID: b85e8535-e946-4c1a-855e-e240a98a57e2

An alert has been generated by Falco, indicating a potential security issue.

**Summary**

A non-trusted program (cat) opened a sensitive file (/etc/shadow) for reading. The file is typically used to store hashed passwords and other sensitive data.

**Alert Information**
---------------------

*   **Time**: 2024-10-10T21:25:20.8339707Z
*   **Priority**: Warning
*   **Rule**: Read sensitive file untrusted
*   **Output**:
    ```
21:25:20.833970700: Warning Sensitive file opened for reading by non-trusted program (file=/etc/shadow gparent=containerd-shim ggparent=systemd gggparent=<NA> evt_type=openat user=root user_uid=0 user_loginuid=-1 process=cat proc_exepath=/bin/cat parent=runc command=cat /etc/shadow terminal=34816 container_id=d2d430b34bdd container_image=docker.io/library/busybox container_image_tag=latest container_name=ping-pod k8s_ns=default k8s_pod_name=ping-pod)
```
*   **Source**: syscall
*   **Tags**:
    *   T1555 (Container)
    *   Filesystem
    *   Host
    *   Maturity_stable
    *   Mitre_credential_access

**Analysis**
-------------

The alert indicates that a non-trusted program (cat) accessed the sensitive file (/etc/shadow). The file is typically used to store hashed passwords and other sensitive data. This could potentially lead to unauthorized access or exposure of sensitive information.

**Mitigation Strategies**
-------------------------

To mitigate this issue, consider the following:

### 1. Review container image configurations

Verify that the container image (docker.io/library/busybox) does not have any unnecessary permissions or access to sensitive files.

*   **Falco Configuration**: Add a custom rule in Falco configuration file (`falco.conf`) to block access to sensitive files:
    ```bash
rule = sensitive_file_access {
  when = openat {
    fd.name = '/etc/shadow'
    user.uid = 0 && user.loginuid != -1
  }
  then = log(message: "Sensitive file /etc/shadow accessed by untrusted program")
}
```
*   **Docker Configuration**: Update the Docker image configuration to restrict access to sensitive files.

### 2. Implement additional security controls

Consider implementing additional security controls, such as:

*   Access control lists (ACLs) for sensitive files
*   Role-based access control (RBAC)
*   Least privilege principle for containers

**Example Docker Configuration**
------------------------------

To restrict access to the `/etc/shadow` file in a Docker container, you can add the following configuration:
```dockerfile
FROM busybox:latest

# Restrict access to /etc/shadow file
RUN chown root:root /etc/shadow
RUN chmod 600 /etc/shadow

CMD ["/bin/cat", "/etc/shadow"]
```
In this example, the `/etc/shadow` file is owned by the `root` user and has restricted permissions (600). The container command uses the `/bin/cat` binary to access the file.

**Conclusion**
----------

This alert highlights a potential security issue where a non-trusted program accessed a sensitive file. By implementing additional security controls, such as reviewing container image configurations, implementing ACLs, or using least privilege principle for containers, you can mitigate this risk and ensure the security of your system.