**Alert Report**
================

**Summary**
------------

A security alert has been generated by Falco due to a suspicious activity detected on the host `k8s-worker-01`. The alert indicates that a non-trusted program attempted to open a sensitive file (`/etc/shadow`) for reading.

**Details**
-----------

The alert details are as follows:

*   **UUID:** `35f3a17a-233b-4ba6-8045-6bae1dd6b7ab`
*   **Output:**

    ```bash
11:56:51.609180738: Warning Sensitive file opened for reading by non-trusted program (file=/etc/shadow gparent=containerd-shim ggparent=systemd gggparent=<NA> evt_type=openat user=root user_uid=0 user_loginuid=-1 process=cat proc_exepath=/usr/bin/cat parent=runc command=cat /etc/shadow terminal=34816 container_id=bb4916bc9bbd container_name=<NA>)
```

    This output indicates that the `cat` program, which is a non-trusted process (identified by `proc.aname[2]=containerd-shim` and `proc.aname[3]=systemd`), attempted to open `/etc/shadow` for reading.

*   **Priority:** Warning
*   **Rule:** Read sensitive file untrusted
*   **Time:** 2024-10-09T11:56:51.609180738Z
*   **Output Fields:**

    | Field        | Value          |
    :--------------|----------------|
    | container.id | bb4916bc9bbd   |
    | container.name| <NA>           |
    | evt.time     | 1728475011609180738 |
    | evt.type     | openat          |
    | fd.name      | /etc/shadow     |
    | proc.aname[2]| containerd-shim|
    | proc.aname[3]| systemd         |
    | proc.tty      | 34816           |
    | user.loginuid| -1              |
    | user.name     | root            |
    | user.uid      | 0               |

**Mitigation and Configuration**
-------------------------------

To mitigate this behavior, the following steps can be taken:

### 1. Restrict file access

Update the system's file permissions to restrict access to sensitive files like `/etc/shadow`. This can be done using the `chmod` command with the appropriate permissions.

```bash
# Set owner and group of /etc/shadow to root only
sudo chown root:root /etc/shadow

# Change permission bits to restrict access
sudo chmod 600 /etc/shadow
```

### 2. Monitor file system activity

Use a logging solution like `syslog` or `journald` to monitor file system activity and detect any suspicious access attempts.

```bash
# Enable syslog for file system events
sudo systemctl enable syslog

# Configure log format to include file system paths
sudo nano /etc/syslog.conf
```

### 3. Limit non-trusted processes

Use a configuration like `/etc/sudoers` or a similar mechanism to limit the actions of non-trusted processes.

```bash
# Deny access to sensitive files for non-root users in sudoers
sudo nano /etc/sudoers
```

Add the following line to the `sudoers` file:

```
cat !root=/etc/shadow ALL=NOPASSWD:ALL!
```

This configuration denies any process from running the `cat` command on `/etc/shadow`.

### 4. Implement additional security measures

Consider implementing additional security measures like encryption, access controls, and least privilege principles to prevent similar incidents in the future.

By following these steps and implementing proper security configurations, you can mitigate the risk associated with this alert and maintain a more secure environment for your hosts.